<?xml version='1.0' encoding="utf-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V4.4//EN" "/usr/share/sgml/docbook/xml-dtd-4.4/docbookx.dtd" [
    <!ENTITY app "Vodcatcher Helper">
]>
<book lang="de">
    <title>&app;
    </title>
    <subtitle>Handbuch</subtitle>
    <bookinfo>
        <author>
            <firstname>Henrik</firstname>
            <surname>Niehaus</surname>
            <email>hampelratte_at_users_dot_berlios_dot_de</email>
        </author>
        <author>
            <firstname>Henk</firstname>
            <surname>Wiedig</surname>
            <email>henkwiedig_at_users_dot_berlios_dot_de</email>
        </author>
    </bookinfo>
    <toc />
    <chapter id="quickstart">
        <title>Schnellstart</title>
        <orderedlist>
            <title>Schritte</title>
            <listitem>
                <para>
                    &app;
                    starten mit
                    <command>bash startServer.sh</command>
                </para>
            </listitem>
            <listitem>
                <para>
                    Parser konﬁgurieren. Per default sind alle Parser
                    ausgeschaltet. Welche
                    Parser gestartet werden, kann
                    unter
                    <code>/conﬁg</code>
                    konﬁguriert werden. Siehe
                    <xref linkend="configuration" />
                    .
                </para>
            </listitem>
            <listitem>
                <para>Parsen der Webseiten starten.</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            Aufrufen der Seite
                            <code>/parse</code>
                        </para>
                    </listitem>
                </itemizedlist>
                <para>
                    Nach dem Parsen, das einige Minuten dauern kann,
                    sind alle verfügbaren
                    Feeds unter
                    <code>/</code>
                    oder
                    <code> /feeds</code>
                    verfügbar.
                </para>
            </listitem>
            <listitem>
                <para>Anpassen der vodcatchersources.conf</para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <code>FEED_URL=http://localhost:8080/feeds
                            </code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code>FEED_URL=http://localhost:8080/groups
                            </code>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <code>FEED_URL=http://localhost:8080/latest
                            </code>
                        </para>
                    </listitem>
                </itemizedlist>
            </listitem>
        </orderedlist>
    </chapter>
    <chapter id="functions">
        <title>Funktionen</title>
        <section>
            <title>Abrufen der RSS-Feeds</title>
            <para>
                Alle verfügbaren RSS-Feeds sind unter
                <code>/</code>
                oder
                <code>/feeds</code>
                verfügbar. Bsp.:
                <code>http://localhost:8080/feeds
                </code>
            </para>
        </section>
        <section>
            <title>Neueste Einträge</title>
            <para>
                Unter
                <code>/latest</code>
                sind die 30 neuesten Einträge zu finden. Die Anzahl der
                Einträge
                kann mit dem Konfigurationsparameter
                <property>latest.items.count
                </property>
                bestimmt werden.
            </para>
        </section>
        <section>
            <title>Suche</title>
            <para>
                Unter
                <code>/search</code>
                kann man nach Einträgen suchen. Der Suchbegriff
                wird als
                Parameter
                <parameter>q</parameter>
                angehängt. Beispielsweise liefert
                <code>http://localhost:8080/search?q=Kerner
                </code>
                Alle Einträge in denen das Wort
                Kerner im Titel oder in
                der Beschreibung vorkommt.
            </para>
        </section>
        <section>
            <title>Gruppen</title>
            <para>
                Unter
                <code>/groups</code>
                findet man Gruppen. Gruppen dienen dazu, mehrere
                gleichartige
                Feeds zusammenzufassen.
            </para>
        </section>
        <section>
            <title>Vordefinierte Gruppen</title>
            <para>Jeder Parser erzeugt eine eigene Gruppe, so dass
                man schnell eine bestimmte
                Sendung finden kann.</para>
        </section>
        <section>
            <title>Eigene Gruppen</title>
            <para>
                Man kann aber auch eigene Gruppen anlegen. Dazu dient
                die Seite
                <code>/group</code>
                config.
                Man könnte z.B. eine Gruppe Kochen erstellen und
                darin alle
                Kochsendungen
                zusammenfassen.
            </para>
        </section>
        <section>
            <title>Benutzerdefinierte Feeds</title>
            <para>
                Unter
                <code>/editfeed</code>
                lassen sich RSS-Feeds manuell hinzufügen, die dann bei jedem Parsen
                mit abgegrast werden. Einfach im oberen Textfeld den URL des RSS-Feeds,
                wie zum Beispiel <code>http://www.cczwei.de/rss_tvissues_all.php</code>,
                eingeben.
                Außerdem lassen sich hier
                auch alle anderen Feeds
                bearbeiten.
            </para>
        </section>
    </chapter>
    <chapter id="configuration">
        <title>Konfiguration</title>
        <para>
            &app;
            kann über die Seite
            <code>/config</code>
            konfiguriert werden. Parameter können andere Parameter
            enthalten,
            siehe z.B.
            <property>db.connection.url</property>
        </para>
        <table>
            <title>Konfigurationsparameter
            </title>
            <tgroup cols="3">
                <colspec colwidth="2*" />
                <colspec colwidth="2*" />
                <colspec />
                <thead>
                    <row>
                        <entry>Parameter</entry>
                        <entry>erlaubte Werte</entry>
                        <entry>Beschreibung</entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>ajax.enabled</entry>
                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>true</para>
                                </listitem>
                                <listitem>
                                    <para>false</para>
                                </listitem>
                            </itemizedlist>
                        </entry>
                        <entry>Aktiviert oder deaktiviert
                            Ajax-Technologie. Javascript wird benötigt
                        </entry>
                    </row>
                    <row>
                        <entry>de.berlios.vch.parser.{Parser}.enabled
                        </entry>
                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>true</para>
                                </listitem>
                                <listitem>
                                    <para>false</para>
                                </listitem>
                            </itemizedlist>
                        </entry>
                        <entry>Aktiviert oder deaktiviert den
                            jeweiligen Parser</entry>
                    </row>
                    <row>
                        <entry>data.dir</entry>
                        <entry>Verzeichnisangabe
                        </entry>
                        <entry>Das
                            Verzeichnis in dem
                            &app;
                            die Daten ablegt
                        </entry>
                    </row>
                    <row>
                        <entry>db.connection.driver
                        </entry>
                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>com.mysql.jdbc.Driver
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>org.hsqldb.jdbcDriver
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </entry>
                        <entry>Der zu nutzende JDBC-Datenbanktreiber
                        </entry>
                    </row>
                    <row>
                        <entry>db.connection.host
                        </entry>

                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>Rechnername</para>
                                </listitem>
                                <listitem>
                                    <para>IP-Adresse</para>
                                </listitem>
                            </itemizedlist>
                        </entry>
                        <entry>Der Rechner, auf dem die Datenbank
                            läuft</entry>

                    </row>
                    <row>
                        <entry>db.connection.port
                        </entry>
                        <entry>Portnummer (0-65535)</entry>
                        <entry>Der Port, auf dem die Datenbank
                            lauscht</entry>
                    </row>
                    <row>
                        <entry>db.connection.url
                        </entry>
                        <entry>
                            JDBC-URL:
                            <itemizedlist>
                                <listitem>
                                    <para>jdbc:mysql://&lt;host&gt;:&lt;port&gt;/&lt;db.name&gt;</para>
                                </listitem>
                                <listitem>
                                    <para>jdbc:hsqldb:file:&lt;data.dir&gt;;shutdown=true</para>
                                </listitem>

                            </itemizedlist>
                        </entry>
                        <entry>Legt die URL fest, die von JDBC benutzt wird.</entry>
                    </row>

                    <row>
                        <entry>db.name</entry>
                        <entry>Zeichenkette</entry>
                        <entry>Der Name der Datenbank, die &app; anlegt</entry>
                    </row>
                    <row>
                        <entry>db.pass</entry>

                        <entry>Zeichenkette</entry>
                        <entry>Das Passwort des Datenbankbenutzers, mit dem &app;
	                auf die Datenbank zugreift</entry>
                    </row>
                    <row>
                        <entry>db.table.{Tabellenname}</entry>
                        <entry>Zeichenkette</entry>
                        <entry>Die Namen der Tabellen, die angelegt werden</entry>

                    </row>
                    <row>
                        <entry>db.user</entry>
                        <entry>Zeichenkette</entry>
                        <entry>Der Benutzername, mit dem &app; auf die
	                Datenbank zugreift</entry>
                    </row>
                    <row>

                        <entry>default.encoding</entry>
                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>iso-8859-1</para>
                                </listitem>
                                <listitem>
                                    <para>iso-8859-15</para>
                                </listitem>
                                <listitem>
                                    <para>utf-8</para>
                                </listitem>
                            </itemizedlist>

                        </entry>
                        <entry>Das Encoding mit dem die RSS-Feeds ausgeliefert werden. Das
Vodcatcher-Plugin erwartet iso-8859-1. VDR unterstützt ab Version 1.6
auch UTF-8. Wer sein System mit UTF-8 betreibt, sollte dann auch
default.encoding auf UTF-8 stellen.
</entry>
                    </row>
                    <row>
                        <entry>docroot</entry>
                        <entry>Verzeichnisangabe</entry>
                        <entry>Verzeichnis, in dem Vodatcherhelper nach Dateien sucht,
	                die über den internen Webserver ausgeliefert werden.</entry>

                    </row>
                    <row>
                        <entry>downloader.concurrent_downloads</entry>
                        <entry>ganze Zahl</entry>
                        <entry>Anzahl der Downloads, die gleichzeitig laufen können.</entry>
                    </row>
                    <row>
                        <entry>html.encoding</entry>
                        <entry>
                            <itemizedlist>
                                <listitem>
                                    <para>iso-8859-1</para>
                                </listitem>
                                <listitem>
                                    <para>iso-8859-15</para>
                                </listitem>

                                <listitem>
                                    <para>utf-8</para>
                                </listitem>
                            </itemizedlist>
                        </entry>
                        <entry>Das Encoding mit dem die HTML-Seiten ausgeliefert werden.</entry>
                    </row>
                    <row>
                        <entry>latest.items.count</entry>
                        <entry>ganze Zahl</entry>
                        <entry>Anzahl der neuen Einträge, die ausgegeben werden (/latest)</entry>
                    </row>
                    <row>
                        <entry>locale.country</entry>
                        <entry>
                            <ulink url="http://www.iso.ch/iso/en/prods-services/iso3166ma/02iso-3166-code-lists/list-en1.html">ISO Country Code</ulink>
                        </entry>
                        <entry>Ein zweistelliger Ländercode in Großbuchstaben.
	                locale.country und locale.language bestimmen zusammen die Sprache, 
	                die &app; spricht</entry>
                    </row>
                    <row>
                        <entry>locale.language</entry>
                        <entry>
                            <ulink url="http://www.loc.gov/standards/iso639-2/php/English_list.php">ISO Language Code</ulink>
                        </entry>
                        <entry>Ein zweistelliger Sprachcode in Kleinbuchstaben.
	                locale.country und locale.language bestimmen zusammen die Sprache, 
	                die &app; spricht</entry>
                    </row>
                    <row>
                        <entry>osdserver.host</entry>
                        <entry>Zeichenkette</entry>
                        <entry>Legt den Rechner fest, auf dem der osdserver läuft.</entry>
                    </row>
                    <row>
                        <entry>osdserver.port</entry>
                        <entry>Portnummer (0-65535)</entry>
                        <entry>Legt den Port fest, auf dem der osdserver lauscht.</entry>
                    </row>
                    <row>
                        <entry>parser.{name}.maxthreads</entry>
                        <entry>ganze Zahl</entry>
                        <entry>Anzahl der Threads, die der jeweilige Parser benutzt</entry>
                    </row>
                    <row>
                        <entry>parser.youtube.urls</entry>
                        <entry>URLs</entry>
                        <entry>Eine Liste von YouTube-Feed-URLs die geparst werden soll. 
	                Die URLs müssen durch Semikolons getrennt sein.</entry>
                    </row>
                    <row>
                        <entry>video.cache.dir</entry>
                        <entry>Verzeichnisangabe</entry>
                        <entry>Das Verzeichnis, in dem &app; Downloads speichert</entry>
                    </row>
                    <row>
                        <entry>webserver.listenport</entry>
                        <entry>Portnummer (0-65535)</entry>
                        <entry>Der Port, auf dem &app; lauschen soll</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>

    </chapter>
    <chapter id="download">
        <title>Download-Funktion</title>
        <para>&app; hat eine eingebaute Download-Funktion, die es ermöglicht,
Videos im Vorhinein herunterzuladen. Das hat den Vorteil, dass die Datei beim
Abspielen nicht mehr gestreamt wird und man die Wiedergabe pausieren und
auch Spulen kann. Im Moment können nur Videos heruntergeladen werden, die auch in der
Datenbank des Vodcatcher Helper vorhanden sind.</para>
        <section>
            <title>Konﬁguration</title>
            <para>Im Folgenden wird immer vom MPlayer-Plugin gesprochen. Für das
xineliboutput-Plugin sollte die Konﬁguration ähnlich sein.
Technisch läuft das Ganze folgendermaßen ab: &app; lädt das Video herunter 
und speichert es im Videoverzeichnis des MPlayer-Plugins. Kurz
nach dem Starten eines Downloads kann man also uber das MPlayer-Plugin das Video starten.
In der Konﬁguration des &app; muss für <property>video.cache.dir</property> also ein
Verzeichnis eingestellt werden, das auch in der mplayersources.conf (zu ﬁnden
z.B. in <filename>/etc/vdr/plugins/mplayer/</filename> ) vorkommt.</para>
        </section>
        <section>
            <title>Downloads starten</title>
            <para>Downloads können auf zwei Arten gestartet werden:</para>
            <orderedlist>
                <listitem>
                    <para>Über das Webinterface. Wählt man unter Feeds einen Feed zum Bearbeiten
aus, kommt man auf die Übersichtsseite des Feeds, auf der alle Videos
angezeigt werden. Am rechten Bildschirmrand gibt es für jedes Video einen
Link <quote>Herunterladen</quote>. Klickt man auf diesen Link, wird der Download des
Videos gestartet.</para>
                </listitem>
                <listitem>
                    <para>Aus dem Vodcatcher-Plugin heraus. Das Zip-Archiv des &app; 
enthält einen Patch, mit dem das Vodcatcher-Plugin um einen Download-Button, 
der auf der blauen Taste liegt, erweitert. So kann man einfach
zu einem Eintrag navigieren und den Download durch einen einfachen Tastendruck starten.</para>
                </listitem>
            </orderedlist>
        </section>
        <section>
            <title>Downloads verwalten</title>
            <para>Im Webinterface ﬁndet man unter Downloads die Downloadverwaltung. Es werden aktive und bereits abgeschlossene Downloads angezeigt. 
Über das Mülleimersymbol können sowohl aktive als auch abgeschlossene Downloads gelöscht
werden. Bei abgeschlossenen Downloads wird dann auch die Videodatei von der
Festplatte gelöscht. Wenn aktive Downloads das Pausieren des Herunterladens unterstützen,
können diese uber das Stopsymbol pausiert und uber das Playsymbol wieder
aufgenommen werden. Nicht alle Downloads unterstützen diese Funktion. Bei
ihnen werden die beiden Symbole nicht angezeigt.</para>
        </section>
    </chapter>

    <chapter id="osdserver">
        <title>OSDServer</title>
        <para>Ab Version 0.5 hat &app; auch eine Schnittstelle zum <ulink url="http://www.udo-richter.de/vdr/osdserver.html">OSDServer-Plugin</ulink> von
        Udo Richter. Das OSDServer-Plugin bietet Anwendungen die Möglichkeit, ein VDR-Menu anzuzeigen und kann in Verbindung mit dieser neuen Schnittstelle 
        von &app; als Alternative zum Vodcatcher-Plugin gesehen werden. Der Vorteil dieser Schnittstelle liegt darin, dass &app; alle Funktionen selbst zur Verfügung stellen kann und nicht vom Vodcatcher-Plugin abhängig
        ist. Neue Funktionen können so schneller umgesetzt werden und auch spezielle Funktionen des &app;, die nicht ins Vodcatcher-Plugin gehören.</para>
        <section>
            <title>Vorraussetung</title>
            <para>Das MPlayer-Plugin ab Version 0.9.15 oder eine Version des xineliboutput-Plugin, die bereits das SVDRP-Kommando PMDA enthält. 
            (Im Moment ist das leider nur im CVS. Stand 15.03.09). Außerdem sollten curl und der at-Daemon installiert sein.</para>
        </section>
        <section>
            <title>Einrichtung des OSDServer-Plugins</title>
            <para>Das OSDServer-Plugin wird wie jedes andere VDR-Plugin installiert. Für Details schau bitte in die VDR Doku.</para>
        </section>
        <section>
            <title>Einrichtung von &app;</title>
            <para>&app; kommuniziert mit dem OSDServer-Plugin über eine Netzwerkverbindung. Daher muss in der Konfiguration von &app; der
        Name (<property>osdserver.host</property>) und der Port (<property>osdserver.port</property>) eingestellt werden. Wenn VDR und &app; auf 
        dem gleichen Rechner laufen sollten die Werte <code>localhost</code> und <code>2010</code> funktionieren.</para>
        </section>
        <section><title>Menu im VDR verfügbar machen</title>
        <para>Das OSDServer-Plugin stellt keinen eigenen Menueintrag zur Verfügung. Um das Menu anzeigen zu lassen, muss man &app; sagen, dass er
        das Menu öffnen soll. Das geht am einfachsten über einen Befehl im Befehle-Menu. Ich habe in der <filename>commands.conf</filename> folgenden Eintrag:
        <code>Vodcatcher: echo "curl http://localhost:8080/osdserver" | at now</code>. Um schneller das Menu öffnen zu können, habe ich noch ein Makro in
        der <filename>keymacros.conf</filename>: <code>User1 Commands 3</code>. 3, weil der Befehl in Zeile 3 steht.
        </para>
        </section>
    </chapter>
    <chapter id="db">
        <title>Externe Datenbanken</title>
        <para>&app; arbeitet mit einer eingebetteten Datenbank. Es ist aber auch
möglich das Programm mit einer externen Datenbank zu betreiben. Um &app; mit einer 
externen Datenbank zu betreiben sind folgende Schritte notwendig:</para>
        <orderedlist>
            <listitem>
                <para>Herunterladen des JDBC-Treibers in das lib/ext Verzeichnis des JRE. Z.B:</para>
                <para><command>cd /opt/sun-jdk-1.6.0.14/jre/lib/ext/</command></para>
                <para><command>wget http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.0.8/mysql-connector-java-5.0.8.jar</command></para>
            </listitem>
            <listitem>
                <para>Speichern der Konﬁgurationsdatei vodcatcherhelper.properties im Hauptverzeichnis:</para>
                <para><command>cd &lt;Verzeichnis von Vodcatcher Helper&gt;</command></para>
                <para><command>unzip -p VodcatcherHelper.jar vodcatcherhelper.properties | grep db. | grep -vh '^#' &gt; vodcatcherhelper.properties</command></para>
            </listitem>
            <listitem>
                <para>Anpassen der Konﬁgurationsdatei.
                Die folgenden Parameter an die neue Umgebung anpassen. Fehlende Parameter sollten ergänzt werden.</para>
                <itemizedlist mark="square">
                    <listitem><property>db.connection.host</property></listitem>
                    <listitem><property>db.connection.port</property></listitem>
                    <listitem><property>db.connection.driver</property></listitem>
                    <listitem><property>db.connection.url</property></listitem>
                    <listitem><property>db.user</property></listitem>
                    <listitem><property>db.pass</property></listitem>
                    <listitem><property>db.name</property></listitem>
                </itemizedlist>
            </listitem>
            <listitem>
                <para>Starten des Servers mit <command>bash startServer.sh</command>
                </para>
            </listitem>
            <listitem>
                <para>Löschen des Verzeichnisses <property>data.dir</property>. Hierin beﬁnden sich die Dateien
der eingebetteten Datenbank, die jetzt nicht mehr benötigt werden.</para>
            </listitem>
        </orderedlist>
        <section>
            <title>Unterstützte Datenbanken</title>
            <itemizedlist>
                <listitem>
                    <table>
                        <title>MySQL</title>
                        <tgroup cols="2">
                            <thead>
                                <row>
                                    <entry>Parameter</entry>
                                    <entry>Wert</entry>
                                </row>
                            </thead>
                            <tbody>
                                <row>
                                    <entry>
                                        <property>db.connection.driver</property>
                                    </entry>
                                    <entry>
                                        <code>com.mysql.jdbc.Driver</code>
                                    </entry>
                                </row>
                                <row>
                                    <entry>
                                        <property>db.connection.url</property>
                                    </entry>
                                    <entry>
                                        <code>jdbc:mysql://&lt;db.connection.host&gt;:&lt;db.connection.port&gt;/&lt;db.name&gt;</code>
                                    </entry>
                                </row>
                            </tbody>
                        </tgroup>
                    </table>
                </listitem>
                <listitem>
                    <table>
                        <title>HSQL</title>
                        <tgroup cols="2">
                            <colspec colname="key" />
                            <colspec colname="value" />
                            <thead>
                                <row>
                                    <entry>Parameter</entry>
                                    <entry>Wert</entry>
                                </row>
                            </thead>
                            <tbody>
                                <row>
                                    <entry>
                                        <property>db.connection.driver</property>
                                    </entry>
                                    <entry>
                                        <code>org.hsqldb.jdbcDriver</code>
                                    </entry>
                                </row>
                                <row>
                                    <entry>
                                        <property>db.connection.url</property>
                                    </entry>
                                    <entry>
                                        <code>jdbc:hsqldb:ﬁle:&lt;data.dir&gt;/&lt;db.name&gt;;shutdown=true</code>
                                    </entry>
                                </row>
                                <row>
                                    <entry namest="key" nameend="value">oder</entry>
                                </row>
                                <row>
                                    <entry>
                                        <property>db.connection.url</property>
                                    </entry>
                                    <entry>
                                        <code>jdbc:hsqldb:hsql://&lt;db.connection.host&gt;/&lt;db.name&gt;</code>
                                    </entry>
                                </row>
                            </tbody>
                        </tgroup>
                    </table>
                </listitem>
            </itemizedlist>
            <para>
Weitere Datenbanken können leicht hinzugefügt werden. Es müssen nur die SQL
Abfragen angepasst werden.
</para>
        </section>
    </chapter>

    <chapter id="thisthat">
        <title>Krimskrams</title>
        <para>
            <code>/handlers</code> Liefert eine Beschreibung aller Seiten, die über das Webinterface aufgerufen werden können</para>
    </chapter>
</book>